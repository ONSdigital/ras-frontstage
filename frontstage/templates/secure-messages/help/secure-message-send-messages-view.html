{% extends "layouts/_block_content.html" %}
{% from "components/button/_macro.njk" import onsButton %}
{% from "components/list/_macro.njk" import onsList %}
{% from "components/panel/_macro.njk" import onsPanel %}
{% from "components/textarea/_macro.njk" import onsTextarea %}
{% from "components/select/_macro.njk" import onsSelect %}

{% block main %}
    <h1>Send a message</h1>
    <p>Describe your issue, and we will get back to you within 5 working days.</p>
    <div class="ons-col-10@m" id="secure-message-form">
        <form method="post">
            {% if options.business %}
                {{
                    onsSelect({
                    "id": "business_id",
                    "name": "business_id",
                    "label": {
                        "text": "Business"
                    },
                    "options": enrolment_options.business,
                    "error": errors.business_id
                    })
                }}
            {% else %}
                <input type="hidden" name="business_id" value="{{ form.business_id }}"/>
            {% endif %}

            {{
                onsSelect({
                    "id": "survey_id",
                    "name": "survey_id",
                    "label": {
                        "text": "Survey"
                    },
                    "options": enrolment_options.survey,
                    "error": errors.survey_id
                })
            }}
            {{
                onsSelect({
                    "id": "subject",
                    "name": "subject",
                    "label": {
                        "text": "Subject"
                    },
                    "options": enrolment_options.subject,
                    "error": errors.subject,
                })
            }}
            {{
                onsTextarea({
                    "id": "secure-message-body",
                    "name": "body",
                    "label": {
                        "text": "Enter message",
                    },
                    "charCheckLimit": false,
                    "error": errors.body,
                    "value": form.body.data
                })
            }}
            <div class="ons-field ons-u-mt-l">
                {{
                    onsButton({
                        "text": "Send message",
                        "id": "send-message-ons-btn",
                        "variants": "loader"
                    })
                }}
                    {{
                        onsButton({
                            "id": "btn-option-cancel",
                            "url": breadcrumbs["option"],
                            "text": 'Cancel',
                            "variants": 'secondary',
                            "noIcon": true
                        })
                    }}
            </div>
             <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
        </form>
    </div>
{% endblock main %}
