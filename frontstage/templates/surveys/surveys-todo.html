{% extends 'layouts/_base.html' %}

{% set page_title = "Surveys to complete" %}

{% block content %}
{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        {% for category, message in messages %}
            {% if category == "error" %}
                {% call onsPanel({
                "type": 'error',
                "id": 'error-id',
                "icon": 'lock',
                "classes": 'u-mb-m'
                }) %}
                    <p class="u-fs-r" id="flashed-error-message-{{ loop.index }}">{{ message }}</p>
                {% endcall %}
            {% else %}
                {% call onsPanel({
                "type": 'success',
                "id": 'success-id',
                "icon": 'check',
                "classes": 'u-mb-m'
                }) %}
                    <p class="u-fs-r" id="flashed-message-{{ loop.index }}">{{ message }}</p>
                {% endcall %}
            {% endif %}
        {% endfor %}
    {% endif %}
{% endwith %}
{% include "partials/tab_list.html" %}

{% if added_survey %}
    {% call onsPanel({
            "type": "success",
            "classes": "u-mb-s"
        }) %}
            Your <a id="NEW_SURVEY_NOTIF" href="#new-survey">new survey</a> has been added.
    {% endcall %}
{% endif %}


{% if already_enrolled %}
    {% call onsPanel({
        "classes": "u-mb-s"
    }) %}
            <div id="ALREADY_ADDED_NOTIF">You have already added that <a href="#new-survey">survey</a> </div>
    {% endcall %}
{% endif %}

<p>
    <a id="add_survey_button" href="{{ url_for('surveys_bp.add_survey') }}">Add a survey</a> using your enrolment code
</p>

{% set emptySurveyListLabel = 'You have no surveys to complete' %}
{% include "surveys/surveys.html" %}

{% endblock content %}
